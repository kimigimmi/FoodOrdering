{"ast":null,"code":"import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport axios from \"axios\";\nconst API = process.env.REACT_APP_API_URL || \"http://localhost:8080\";\nexport const fetchItems = createAsyncThunk(\"items/fetch\", async (_, {\n  getState,\n  rejectWithValue\n}) => {\n  var _params$page, _params$limit;\n  const {\n    params\n  } = getState().items;\n  const searchParams = new URLSearchParams();\n  if (params.q) searchParams.set(\"q\", params.q);\n  if (params.category) searchParams.set(\"category\", params.category);\n  if (params.sort) searchParams.set(\"sort\", params.sort);\n  searchParams.set(\"page\", String((_params$page = params.page) !== null && _params$page !== void 0 ? _params$page : 1));\n  searchParams.set(\"limit\", String((_params$limit = params.limit) !== null && _params$limit !== void 0 ? _params$limit : 12));\n  try {\n    const {\n      data\n    } = await axios.get(`${API}/api/items?${searchParams.toString()}`);\n    return {\n      items: data.items,\n      total: data.total\n    };\n  } catch (e) {\n    var _e$response, _e$response$data;\n    const msg = (e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.error) || e.message || \"Request failed\";\n    return rejectWithValue(msg);\n  }\n});\nconst initialState = {\n  data: [],\n  total: 0,\n  loading: false,\n  error: undefined,\n  params: {\n    sort: \"newest\",\n    page: 1,\n    limit: 12\n  }\n};\nconst itemsSlice = createSlice({\n  name: \"items\",\n  initialState,\n  reducers: {\n    setParams: (s, a) => {\n      s.params = {\n        ...s.params,\n        ...a.payload\n      };\n    }\n  },\n  extraReducers: b => {\n    b.addCase(fetchItems.pending, s => {\n      s.loading = true;\n      s.error = undefined;\n    });\n    b.addCase(fetchItems.fulfilled, (s, a) => {\n      s.loading = false;\n      s.data = a.payload.items;\n      s.total = a.payload.total;\n    });\n    b.addCase(fetchItems.rejected, (s, a) => {\n      s.loading = false;\n      s.error = String(a.payload || a.error.message || \"Request failed\");\n    });\n  }\n});\nexport const {\n  setParams\n} = itemsSlice.actions;\nexport default itemsSlice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","API","process","env","REACT_APP_API_URL","fetchItems","_","getState","rejectWithValue","_params$page","_params$limit","params","items","searchParams","URLSearchParams","q","set","category","sort","String","page","limit","data","get","toString","total","e","_e$response","_e$response$data","msg","response","error","message","initialState","loading","undefined","itemsSlice","name","reducers","setParams","s","a","payload","extraReducers","b","addCase","pending","fulfilled","rejected","actions","reducer"],"sources":["C:/Users/SÃ¼leyman/Desktop/FoodOrdering/frontend/src/store/itemsSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\nimport type { Item } from \"../types\";\r\n\r\ntype Sort = \"newest\" | \"price_asc\" | \"price_desc\" | \"rating_desc\";\r\n\r\nexport type ItemsParams = {\r\n  q?: string;\r\n  category?: string;\r\n  sort?: Sort;\r\n  page?: number;\r\n  limit?: number;\r\n};\r\n\r\ntype State = {\r\n  data: Item[];\r\n  total: number;\r\n  loading: boolean;\r\n  error?: string;\r\n  params: ItemsParams;\r\n};\r\n\r\nconst API = process.env.REACT_APP_API_URL || \"http://localhost:8080\";\r\n\r\nexport const fetchItems = createAsyncThunk<\r\n  { items: Item[]; total: number },\r\n  void,\r\n  { state: { items: State } }\r\n>(\"items/fetch\", async (_, { getState, rejectWithValue }) => {\r\n  const { params } = getState().items;\r\n  const searchParams = new URLSearchParams();\r\n\r\n  if (params.q) searchParams.set(\"q\", params.q);\r\n  if (params.category) searchParams.set(\"category\", params.category);\r\n  if (params.sort) searchParams.set(\"sort\", params.sort);\r\n  searchParams.set(\"page\", String(params.page ?? 1));\r\n  searchParams.set(\"limit\", String(params.limit ?? 12));\r\n\r\n  try {\r\n    const { data } = await axios.get(`${API}/api/items?${searchParams.toString()}`);\r\n    return { items: data.items as Item[], total: data.total as number };\r\n  } catch (e: any) {\r\n    const msg = e?.response?.data?.error || e.message || \"Request failed\";\r\n    return rejectWithValue(msg);\r\n  }\r\n});\r\n\r\nconst initialState: State = {\r\n  data: [],\r\n  total: 0,\r\n  loading: false,\r\n  error: undefined,\r\n  params: { sort: \"newest\", page: 1, limit: 12 },\r\n};\r\n\r\nconst itemsSlice = createSlice({\r\n  name: \"items\",\r\n  initialState,\r\n  reducers: {\r\n    setParams: (s, a: PayloadAction<Partial<ItemsParams>>) => {\r\n      s.params = { ...s.params, ...a.payload };\r\n    },\r\n  },\r\n  extraReducers: (b) => {\r\n    b.addCase(fetchItems.pending, (s) => {\r\n      s.loading = true;\r\n      s.error = undefined;\r\n    });\r\n    b.addCase(fetchItems.fulfilled, (s, a) => {\r\n      s.loading = false;\r\n      s.data = a.payload.items;\r\n      s.total = a.payload.total;\r\n    });\r\n    b.addCase(fetchItems.rejected, (s, a) => {\r\n      s.loading = false;\r\n      s.error = String(a.payload || a.error.message || \"Request failed\");\r\n    });\r\n  },\r\n});\r\n\r\nexport const { setParams } = itemsSlice.actions;\r\nexport default itemsSlice.reducer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}