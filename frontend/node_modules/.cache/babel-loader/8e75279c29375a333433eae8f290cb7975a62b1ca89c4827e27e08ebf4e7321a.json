{"ast":null,"code":"import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\nimport axios from 'axios';\nimport { API } from '../lib/api';\nconst initial = {\n  data: [],\n  loading: false,\n  error: null,\n  total: 0,\n  params: {\n    q: '',\n    category: '',\n    sort: 'newest',\n    page: 1,\n    limit: 12\n  }\n};\nexport const fetchItems = createAsyncThunk('items/fetch', async (overrideParams, thunk) => {\n  const state = thunk.getState().items;\n  const p = {\n    ...state.params,\n    ...(overrideParams || {})\n  };\n  const qs = new URLSearchParams({\n    ...(p.q ? {\n      q: p.q\n    } : {}),\n    ...(p.category ? {\n      category: p.category\n    } : {}),\n    ...(p.sort ? {\n      sort: p.sort\n    } : {}),\n    ...(p.page ? {\n      page: String(p.page)\n    } : {}),\n    ...(p.limit ? {\n      limit: String(p.limit)\n    } : {})\n  }).toString();\n  const {\n    data\n  } = await axios.get(`${API}/api/items?${qs}`);\n  return data;\n});\nconst slice = createSlice({\n  name: 'items',\n  initialState: initial,\n  reducers: {\n    setParams(state, action) {\n      state.params = {\n        ...state.params,\n        ...action.payload\n      };\n    }\n  },\n  extraReducers: b => {\n    b.addCase(fetchItems.pending, s => {\n      s.loading = true;\n      s.error = null;\n    }).addCase(fetchItems.fulfilled, (s, a) => {\n      s.loading = false;\n      s.data = a.payload.items;\n      s.total = a.payload.total;\n    }).addCase(fetchItems.rejected, (s, a) => {\n      var _a$error$message;\n      s.loading = false;\n      s.error = (_a$error$message = a.error.message) !== null && _a$error$message !== void 0 ? _a$error$message : 'failed';\n    });\n  }\n});\nexport const {\n  setParams\n} = slice.actions;\nexport default slice.reducer;","map":{"version":3,"names":["createAsyncThunk","createSlice","axios","API","initial","data","loading","error","total","params","q","category","sort","page","limit","fetchItems","overrideParams","thunk","state","getState","items","p","qs","URLSearchParams","String","toString","get","slice","name","initialState","reducers","setParams","action","payload","extraReducers","b","addCase","pending","s","fulfilled","a","rejected","_a$error$message","message","actions","reducer"],"sources":["C:/Users/SÃ¼leyman/Desktop/FoodOrdering/frontend/src/store/itemsSlice.ts"],"sourcesContent":["import { createAsyncThunk, createSlice } from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { API } from '../lib/api';\r\nimport type { Item } from '../types';\r\n\r\nexport type ItemsParams = {\r\n  q?: string;\r\n  category?: string;\r\n  sort?: 'newest' | 'price_asc' | 'price_desc' | 'rating_desc';\r\n  page?: number;\r\n  limit?: number;\r\n};\r\n\r\ntype State = {\r\n  data: Item[];\r\n  loading: boolean;\r\n  error?: string | null;\r\n  total: number;\r\n  params: ItemsParams;\r\n};\r\n\r\nconst initial: State = {\r\n  data: [],\r\n  loading: false,\r\n  error: null,\r\n  total: 0,\r\n  params: { q: '', category: '', sort: 'newest', page: 1, limit: 12 }\r\n};\r\n\r\nexport const fetchItems = createAsyncThunk<{ items: Item[]; total: number }, ItemsParams | void, { state: { items: State } }>(\r\n  'items/fetch',\r\n  async (overrideParams, thunk) => {\r\n    const state = thunk.getState().items;\r\n    const p = { ...state.params, ...(overrideParams || {}) };\r\n    const qs = new URLSearchParams({\r\n      ...(p.q ? { q: p.q } : {}),\r\n      ...(p.category ? { category: p.category } : {}),\r\n      ...(p.sort ? { sort: p.sort } : {}),\r\n      ...(p.page ? { page: String(p.page) } : {}),\r\n      ...(p.limit ? { limit: String(p.limit) } : {})\r\n    }).toString();\r\n    const { data } = await axios.get<{ items: Item[]; total: number }>(`${API}/api/items?${qs}`);\r\n    return data;\r\n  }\r\n);\r\n\r\nconst slice = createSlice({\r\n  name: 'items',\r\n  initialState: initial,\r\n  reducers: {\r\n    setParams(state, action) { state.params = { ...state.params, ...action.payload }; }\r\n  },\r\n  extraReducers: b => {\r\n    b.addCase(fetchItems.pending, s => { s.loading = true; s.error = null; })\r\n     .addCase(fetchItems.fulfilled, (s, a) => { s.loading = false; s.data = a.payload.items; s.total = a.payload.total; })\r\n     .addCase(fetchItems.rejected, (s, a) => { s.loading = false; s.error = a.error.message ?? 'failed'; });\r\n  }\r\n});\r\n\r\nexport const { setParams } = slice.actions;\r\nexport default slice.reducer;\r\n"],"mappings":"AAAA,SAASA,gBAAgB,EAAEC,WAAW,QAAQ,kBAAkB;AAChE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,GAAG,QAAQ,YAAY;AAmBhC,MAAMC,OAAc,GAAG;EACrBC,IAAI,EAAE,EAAE;EACRC,OAAO,EAAE,KAAK;EACdC,KAAK,EAAE,IAAI;EACXC,KAAK,EAAE,CAAC;EACRC,MAAM,EAAE;IAAEC,CAAC,EAAE,EAAE;IAAEC,QAAQ,EAAE,EAAE;IAAEC,IAAI,EAAE,QAAQ;IAAEC,IAAI,EAAE,CAAC;IAAEC,KAAK,EAAE;EAAG;AACpE,CAAC;AAED,OAAO,MAAMC,UAAU,GAAGf,gBAAgB,CACxC,aAAa,EACb,OAAOgB,cAAc,EAAEC,KAAK,KAAK;EAC/B,MAAMC,KAAK,GAAGD,KAAK,CAACE,QAAQ,CAAC,CAAC,CAACC,KAAK;EACpC,MAAMC,CAAC,GAAG;IAAE,GAAGH,KAAK,CAACT,MAAM;IAAE,IAAIO,cAAc,IAAI,CAAC,CAAC;EAAE,CAAC;EACxD,MAAMM,EAAE,GAAG,IAAIC,eAAe,CAAC;IAC7B,IAAIF,CAAC,CAACX,CAAC,GAAG;MAAEA,CAAC,EAAEW,CAAC,CAACX;IAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAC1B,IAAIW,CAAC,CAACV,QAAQ,GAAG;MAAEA,QAAQ,EAAEU,CAAC,CAACV;IAAS,CAAC,GAAG,CAAC,CAAC,CAAC;IAC/C,IAAIU,CAAC,CAACT,IAAI,GAAG;MAAEA,IAAI,EAAES,CAAC,CAACT;IAAK,CAAC,GAAG,CAAC,CAAC,CAAC;IACnC,IAAIS,CAAC,CAACR,IAAI,GAAG;MAAEA,IAAI,EAAEW,MAAM,CAACH,CAAC,CAACR,IAAI;IAAE,CAAC,GAAG,CAAC,CAAC,CAAC;IAC3C,IAAIQ,CAAC,CAACP,KAAK,GAAG;MAAEA,KAAK,EAAEU,MAAM,CAACH,CAAC,CAACP,KAAK;IAAE,CAAC,GAAG,CAAC,CAAC;EAC/C,CAAC,CAAC,CAACW,QAAQ,CAAC,CAAC;EACb,MAAM;IAAEpB;EAAK,CAAC,GAAG,MAAMH,KAAK,CAACwB,GAAG,CAAmC,GAAGvB,GAAG,cAAcmB,EAAE,EAAE,CAAC;EAC5F,OAAOjB,IAAI;AACb,CACF,CAAC;AAED,MAAMsB,KAAK,GAAG1B,WAAW,CAAC;EACxB2B,IAAI,EAAE,OAAO;EACbC,YAAY,EAAEzB,OAAO;EACrB0B,QAAQ,EAAE;IACRC,SAASA,CAACb,KAAK,EAAEc,MAAM,EAAE;MAAEd,KAAK,CAACT,MAAM,GAAG;QAAE,GAAGS,KAAK,CAACT,MAAM;QAAE,GAAGuB,MAAM,CAACC;MAAQ,CAAC;IAAE;EACpF,CAAC;EACDC,aAAa,EAAEC,CAAC,IAAI;IAClBA,CAAC,CAACC,OAAO,CAACrB,UAAU,CAACsB,OAAO,EAAEC,CAAC,IAAI;MAAEA,CAAC,CAAChC,OAAO,GAAG,IAAI;MAAEgC,CAAC,CAAC/B,KAAK,GAAG,IAAI;IAAE,CAAC,CAAC,CACvE6B,OAAO,CAACrB,UAAU,CAACwB,SAAS,EAAE,CAACD,CAAC,EAAEE,CAAC,KAAK;MAAEF,CAAC,CAAChC,OAAO,GAAG,KAAK;MAAEgC,CAAC,CAACjC,IAAI,GAAGmC,CAAC,CAACP,OAAO,CAACb,KAAK;MAAEkB,CAAC,CAAC9B,KAAK,GAAGgC,CAAC,CAACP,OAAO,CAACzB,KAAK;IAAE,CAAC,CAAC,CACpH4B,OAAO,CAACrB,UAAU,CAAC0B,QAAQ,EAAE,CAACH,CAAC,EAAEE,CAAC,KAAK;MAAA,IAAAE,gBAAA;MAAEJ,CAAC,CAAChC,OAAO,GAAG,KAAK;MAAEgC,CAAC,CAAC/B,KAAK,IAAAmC,gBAAA,GAAGF,CAAC,CAACjC,KAAK,CAACoC,OAAO,cAAAD,gBAAA,cAAAA,gBAAA,GAAI,QAAQ;IAAE,CAAC,CAAC;EACzG;AACF,CAAC,CAAC;AAEF,OAAO,MAAM;EAAEX;AAAU,CAAC,GAAGJ,KAAK,CAACiB,OAAO;AAC1C,eAAejB,KAAK,CAACkB,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}